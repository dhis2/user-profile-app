language: node_js
node_js:
- '8'
before_script:
- npm install --global @dhis2/deploy-build
script:
- npm run build
deploy:
- provider: script
  script: deploy-build
  skip_cleanup: true
  on:
    all_branches: true
- provider: script
  script: publish-build
  skip_cleanup: true
  on:
    tags: true
env:
  global:
    secure: WgMgpzIIcP1q9Oybo4JWSgwsuqTJjW6JCtPlsQrcC4VnfAihfPYwTKRtWrkbMPOcfxrrluxqYpfNtHYEbIbbrSegzuZYBczQnCfEYf/fjt3Y+thFrUy0PBCaSkYyKOE4b9vDZVkIWGVMTwMhmOGuZITmvYSuSlnqHNpnfJC0/CHMSDMp8eCukjYAnNYskOFlQu7poIGgyK7LasjzL+U/ewQKl2vcIHj3utbZTnjXn0tQhtqHski123N+kUxe9hHv6XrVZbvZxstEKbfTc0ERhybBqgOME+oy8hoagq31CtyvM48owO7sjaTelheYohvkiCpq0S5bmvFvo3os7N/fSyAVwNK4DZWDNBDeijkJS2WKGs8nEJrv+ZyDtA61GU2teUiD38sH9O05BVJeK/BcFMiLXcji/xGsGG0Vh8YM/qMa+z3eqx77QKGQFl7uhi/JBA1WzjFO/+ndiqSVMJOU7G7YZ8VgNZhZSzQlWVT5LUUxbmWSaMulFjnCBDXZjHleVzgIfwi+lqQoDgr6cCd5JDZe0UUskPS72nWDOadH5z1G961tsnRs96nBYJxL4fV1DsZu6SSPgIBR2WQ9FgvSfYcz1zYENtpmp5vKxMb7CGE1hbDPmd86aTo3m4QFT6OlA80Fn3UWdBJlUyyUh+c/1VOoc9NS+QpoOXU0NelLhWQ=
notifications:
  slack:
    secure: XNn7crR2jyRC8moaflq5wTmDeVu06l5ngw2jIUu+54dWHdansaL+jFrAbZU8snVfGQ9axANwaITuV/ziW2UAwMoZvmtNdGSJvUgdO+yIhUhCF5Uy02WP3u1xQAfk4bWVoEXod/jJ4VnjOQ8AHE8clcgx5rCD1nuK+ChYdpmP68lm7Gs+C/TrfwSU7EfdBS2vqZ3KklfUzZwlnHYBslaCtrAfDGBRwF59gyqsVscQjG0cP6Frxp0a1BEMWmVrfMikkfzpzToe+dQIkroLfAHPK8iCSWw5/Jf4ZJLiOu4sZ79RKPdbPGjTiUNZ9alMFfK+M3vAonFQdpxokQAQ7tn1FcGdAtM5wUiZ+hD04K66D5QHZc2lwRDpfZmKr/TliFMK8ZNc0Vks3sfnUpnD1TrPjAlsndM28nkmemBPPTOfibpre1AjT2G9LyOF83GLzREjEQQpPCXfb4bA11UHtT9xfP75fozcQSh08UdQTkIK6LE8711pQQpIe9mgHKjJTKkm7N0OF5BMH5j+FAJpUK9ruhvwfCoo/U+6XexOB+VBqz1NGmUa8P8G1Q/WmOuzhqQURk4ImVvZNGL7GVVaqgV/GDN0OZEV+DMkWxSpK4bx/GmGvRSzy33C3lBoearKVJXo7/5gsQaSzvnpQO/P/8VvS7K/e6DoL99Jl/cCxaN36Q4=
    on_success: change
    on_failure: always
